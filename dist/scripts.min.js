"use strict";function themeSwitcher(){function a(){g.classList.add("hide"),f.classList.remove("hide"),i.textContent="off"}function b(){f.classList.add("hide"),g.classList.remove("hide"),i.textContent="on"}const c=`${"TODOS-v2-local"}-switcher`,d=document.getElementById("btn-theme-toggle"),f=document.getElementById("theme-lightmode"),g=document.getElementById("theme-darkmode"),h=document.querySelector("html"),i=document.getElementById("mode");d.addEventListener("click",d=>{d.preventDefault(),h.classList.toggle("light-theme");const e=h.classList.contains("light-theme");d.target.setAttribute("aria-pressed",e+""),e?a():b();const i=f.classList.contains("hide")?"hide":"",j=g.classList.contains("hide")?"hide":"";localStorage.setItem(c,JSON.stringify([e,i,j]))}),function(){const e=JSON.parse(localStorage.getItem(c))||[!1,"",""],f=e[0];f?(h.classList.add("light-theme"),a()):(h.classList.remove("light-theme"),b()),d.setAttribute("aria-pressed",f+"")}()}themeSwitcher();function loadingAnimation(){window.addEventListener("load",()=>{const a=document.getElementById("loader"),b=document.getElementById("page-loaded");a.classList.add("loader-hidden"),a.addEventListener("transitionend",()=>{a.remove(),b.textContent="Page has loaded.",b.setAttribute("aria-hidden","false")})})}loadingAnimation();const deleteAllBtn=document.querySelector("[data-delete-all-todos]");function deleteAllTodos(){deleteAllBtn.addEventListener("click",()=>{if(window.confirm("Do you really want to delete all to-dos?")){["SORTABLE-TODO-LIST_DIST-todos-redo","SORTABLE-TODO-LIST_DIST-sort-dates-enabled","SORTABLE-TODO-LIST_DIST-toolbar-border-state","SORTABLE-TODO-LIST_DIST-list-border-state"].forEach(a=>{for(let b=0;b<localStorage.length;b++){const c=localStorage.key(b);c.startsWith(a)&&localStorage.removeItem(c)}}),window.location.reload()}})}function enableDeleteAllBtn(a){1<a.length&&deleteAllBtn.removeAttribute("disabled")}deleteAllBtn.setAttribute("disabled",""),deleteAllTodos();function toDoList(){function a(a){const b=u.content.cloneNode(!0),c=b.querySelector(".list-item");c.dataset.todoId=a.id;const d=b.querySelector("[data-list-item-text]");if(d.innerText=a.name,a.date){const c=b.querySelector("[data-list-item-date]"),d=a.date.split("/"),e=new Date(`${d[1]}/${d[0]}/${d[2]}`);c.textContent=e.toLocaleDateString("en-GB")}const e=b.querySelector("[data-button-complete]");e.innerText=a.complete?"Uncomplete":"Complete",c.classList.toggle("complete",a.complete),i(),enableDeleteAllBtn(w),t.appendChild(b)}function b(){localStorage.setItem(k,JSON.stringify(w))}function c(a){localStorage.setItem(n,JSON.stringify(a))}function d(){const a=localStorage.getItem(n);return JSON.parse(a)||!1}function f(a){localStorage.setItem(m,JSON.stringify(a))}function g(){const a=localStorage.getItem(m);return JSON.parse(a)||!1}function h(){b(),t.innerHTML="",w.forEach(b=>a(b))}function i(){2<=w.length?(v.removeAttribute("disabled"),localStorage.setItem(l,"true")):(v.setAttribute("disabled",""),localStorage.setItem(l,"false"))}function j(a){const b=a.split("/"),c=b.reverse(),d=c.join("/");return new Date(d)}const k=`${"SORTABLE-TODO-LIST_DIST"}-todos-redo`,l=`${"SORTABLE-TODO-LIST_DIST"}-sort-dates-enabled`,m=`${"SORTABLE-TODO-LIST_DIST"}-toolbar-border-state`,n=`${"SORTABLE-TODO-LIST_DIST"}-list-border-state`,o=document.querySelector("#new-todo-form"),p=document.getElementById("reset"),q=document.querySelector("[data-input-text]"),r=document.querySelector("[data-input-date]"),s=document.getElementById("toolbar"),t=document.getElementById("list"),u=document.querySelector("#list-item-template"),v=document.querySelector("[data-sort-button]");v.setAttribute("disabled","");let w=function(){const a=localStorage.getItem(k);return JSON.parse(a)||[]}();w.forEach(b=>a(b)),o.addEventListener("submit",d=>{d.preventDefault();const e=q.value,g=r.value,h=g.split("-"),i=h.reverse().join("/");if(""===e)return;const j={date:i,name:e,complete:!1,edited:!1,id:new Date().valueOf().toString()};w.push(j),a(j),b(),r.value="",q.value="",q.setAttribute("placeholder","Add a task...");const k=document.querySelectorAll(".list-item"),l=0<k.length;t.classList.toggle("js-visibility",l),c(l);const m=1<k.length;s.classList.toggle("js-visibility",m),f(m)}),t.addEventListener("click",a=>{if(!a.target.matches("[data-button-edit]"))return;a.target.innerText="Edit"===a.target.innerText?"Save edit":"Edit";const c=a.target.closest(".list-item"),d=c.querySelector("[data-list-item-text]");d.toggleAttribute("contenteditable");const e=c.dataset.todoId,f=w.find(a=>a.id===e);f.edited=!d.hasAttribute("contenteditable"),f.edited&&(f.name=d.innerText),b()}),t.addEventListener("click",a=>{if(!a.target.matches("[data-button-complete]"))return;a.target.innerText="Complete"===a.target.innerText?"Uncomplete":"Complete";const c=a.target.closest(".list-item");c.classList.toggle("complete");const d=c.dataset.todoId,e=w.find(a=>a.id===d);e.complete=c.classList.contains("complete"),b()}),t.addEventListener("click",a=>{if(!a.target.matches("[data-button-delete]"))return;const d=a.target.closest(".list-item");d.remove();const e=d.dataset.todoId;w=w.filter(a=>a.id!==e),b();const g=document.querySelectorAll(".list-item");2>g.length&&(deleteAllBtn.setAttribute("disabled",""),v.setAttribute("disabled",""));const h=0<g.length;t.classList.toggle("js-visibility",h),c(h);const i=1<g.length;s.classList.toggle("js-visibility",i),f(i)}),document.addEventListener("DOMContentLoaded",()=>{const a=d();t.classList.toggle("js-visibility",a);const b=g();s.classList.toggle("js-visibility",b)}),v.addEventListener("click",()=>{w.sort((c,a)=>j(c.date)-j(a.date)),h()}),p.addEventListener("click",a=>{a.preventDefault(),r.value="",q.value=""})}toDoList();